---
# yaml-language-server: $schema=https://schema.blue-build.org/module-list-v1.json
modules:

  - type: files
    files:
      - source: system
        destination: /

  - type: dnf
    install:
      packages:
        # GNOME Core (Minimal)
        - gdm                               # Login Manager
        - gnome-shell                       # Desktop Interface
        - gnome-session-wayland-session     # Wayland Session
        - gnome-control-center              # Settings
        - gnome-system-monitor              # Task manager
        - gnome-settings-daemon             # Hardware management
        - dconf                             # Basically GNOMEs version of registry keys
        
        # Essential Interface & Tools
        - nautilus                          # File Manager
        - gnome-console                     # Minimal Terminal
        - gvfs                              # Virtual Filesystem (Trash/Mounts)
        - xdg-desktop-portal-gnome          # Flatpak Portal Support
        - gnome-keyring                     # Password/Key Management

        # Networking
        - NetworkManager-wifi               # Ensure WiFi support
        
        # Utilities
        - distrobox                         # Container-based system management
        - steam                             # Primary gaming platform
        - micro                             # TUI Text Editor
        
        # Bazaar runtime dependencies
        - gtk4
        - libadwaita
        - libdex
        - flatpak
        - appstream
        - json-glib
        - libsoup3
        - libxmlb
        - libyaml
        - webkitgtk6.0
        - libsecret
        - openssl-libs
        - glycin-loaders
        # NOTE: libglycin-gtk4-2.so.0 is preserved by the build script
        # No need to explicitly install it here
        
    remove:
      packages:
        - toolbox
        - htop
        - nvtop

  - type: script
    scripts:
      - build-bazaar.sh
      - dconf-update.sh
      #- preinstall-distrobox.sh

  - type: systemd
    system:
      enabled:
        - gdm.service

  - type: default-flatpaks
    configurations:
      - notify: true
        scope: system
        repo:
          title: Flathub (System)
        install:
          - com.github.tchx84.Flatseal
          - com.ranfdev.DistroShelf
          - ca.desrt.dconf-editor
          - io.github.flattool.Ignition
          - com.usebottles.bottles
          - com.mattjakeman.ExtensionManager
          - org.mozilla.firefox
          - io.github.celluloid_player.Celluloid
          - com.vysp3r.ProtonPlus
          - me.timschneeberger.jdsp4linux
          - org.gnome.font-viewer
          - org.gnome.Logs
          - org.gnome.FileRoller
          - org.gnome.TextEditor
          - org.gnome.Calculator
          - org.gnome.Loupe
          - org.gnome.Papers
          - org.gnome.Contacts
          - org.gnome.Calendar
          - org.gnome.clocks
          - org.gnome.NetworkDisplays
          - org.gnome.Boxes
          - org.gnome.Weather
          - org.gnome.SoundRecorder

  - type: gnome-extensions
    install:
      - 615 # appindicator support
      - 8 # places menu
      - 1319 # gsconnect
      - 517 # caffeine
      - 5263 # gtk desktop icons ng (ding)
      - 600 # launch new instance
      - 36 # lock keys