---
# yaml-language-server: $schema=https://schema.blue-build.org/module-list-v1.json
modules:

  - type: files
    files:
      - source: system
        destination: /

  #- type: os-release
  #  properties:
  #    NAME: bog
  #    PRETTY_NAME: bog 43
  #    ID: fedora
  #    ID_LIKE: fedora
  #    VERSION_ID: 43

  - type: script
    scripts:
      - fix-libsoup3-multilib.sh

  - type: dnf
    repos:
      copr:
        enable:
          - lilay/topgrade # Officially recommended COPR repo for Topgrade
    install:
      packages:

        # GNOME Core (Minimal)
        - gdm                               # Login Manager
        - gnome-shell                       # Desktop Interface
        - gnome-session-wayland-session     # Wayland Session
        - gnome-control-center              # Settings
        - gnome-system-monitor              # Task manager
        - gnome-settings-daemon             # Hardware management
        - dconf                             # Basically GNOMEs version of registry keys
        - dconf-editor                      # Basically GNOMEs version of registry editor

        # Essential Interface & Tools
        - gnome-console                     # Terminal emulator
        - gvfs                              # Virtual Filesystem (Trash/Mounts)
        - xdg-desktop-portal-gnome          # Flatpak Portal Support
        - gnome-keyring                     # Password/Key Management
        - gnome-disk-utility                # GNOME Disks
        - baobab                            # Dir tree analyzer
        - gnome-logs                        # SystemD log viewer
        - gnome-font-viewer                 # Font viewer/installer
        - nautilus                          # File manager
        - gnome-text-editor                 # Text editor

        # Networking
        - NetworkManager-wifi               # Ensure WiFi support

        # Utilities
        - distrobox                         # Container-based system management
        - steam                             # Primary gaming platform
        - micro                             # TUI Text Editor
        - wget                              # CLI for http transfer/download
        - curl                              # The other CLI for http transfer/download
        - git                               # Version control system
        - yt-dlp                            # CLI media downloader
        - ffmpeg                            # Suite of media processing libraries
        - topgrade                          # Universal system updater (COPR)
        - fastfetch                         # System information readout (neofetch-like)

        # Podman stuff
        - podman                            # Should already be present on ublue base
        - podman-compose                    # Fallback CLI if ever needed
        - slirp4netns                       # Rootless networking
        - fuse-overlayfs                    # Rootless storage driver

        # Bazaar runtime dependencies
        - gtk4
        - libadwaita
        - libdex
        - flatpak
        - appstream
        - json-glib
        - libsoup3
        - libxmlb
        - libyaml
        - webkitgtk6.0
        - libsecret
        - openssl-libs
        - glycin-loaders
        - md4c
        - glycin-gtk4-libs
        - libgweather4
    remove:
      packages:
        - toolbox
        - htop
        - nvtop

  - type: systemd
    system:
      enabled:
        - gdm.service

  - type: script
    scripts:
      - build-bazaar.sh
      - setup-podman.sh
      - dconf-update.sh

  - type: default-flatpaks
    configurations:
      - notify: true
        scope: system
        repo:
          title: Flathub (System)
        install:
          - com.github.tchx84.Flatseal
          - com.ranfdev.DistroShelf
          - io.github.flattool.Ignition
          - com.mattjakeman.ExtensionManager
          - org.mozilla.firefox
          - io.github.celluloid_player.Celluloid
          - com.vysp3r.ProtonPlus
          - com.usebottles.bottles
          - me.timschneeberger.jdsp4linux

          # Pre-installed selection from other curated groups
          - org.qbittorrent.qBittorrent

          # Pre-installed selection from GNOME Bazaar curation group
          - org.gnome.Contacts
          - org.gnome.Calendar
          - org.gnome.clocks
          - org.gnome.SoundRecorder
          - org.gnome.Decibels
          - org.gnome.Snapshot
          - org.gnome.Characters
          - org.gnome.SimpleScan

  - type: gnome-extensions
    install:
      - 615 # AppIndicator Support
      - 8 # Places Menu
      - 1319 # GSConnect
      - 517 # Caffeine
      - 5263 # GTK Desktop Icons NG (DING)
      - 600 # Launch New Instance
      - 36 # Lock Keys
      - 5904 # Volume Scroller